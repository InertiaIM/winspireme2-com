(function(a){a.fn.stupidtable=function(h){return this.each(function(){var c=a(this);h=h||{};h=a.extend({},{"int":function(a,b){return parseInt(a,10)-parseInt(b,10)},"float":function(a,b){return parseFloat(a)-parseFloat(b)},string:function(a,b){return a<b?-1:a>b?1:0}},h);c.on("click","th",function(){var n=c.children("tbody").children("tr"),b=a(this),j=0,m=a.fn.stupidtable.dir;c.find("th").slice(0,b.index()).each(function(){var b=a(this).attr("colspan")||1;j+=parseInt(b,10)});var l=b.data("sort-dir")===
m.ASC?m.DESC:m.ASC,p=l==m.DESC?b.data("sort-desc")||b.data("sort")||null:b.data("sort")||null;null!==p&&(c.trigger("beforetablesort",{column:j,direction:l}),c.css("display"),setTimeout(function(){var k=[],d=h[p];n.each(function(b,d){var c=a(d).children().eq(j),e=c.data("sort-value"),c="undefined"!==typeof e?e:c.text();k.push(c)});var e=[],f=0;if(b.data("sort-dir")&&!b.data("sort-desc"))for(d=k.length-1;0<=d;d--)e.push(d);else for(var g=k.slice(0).sort(d),d=0;d<k.length;d++){for(f=a.inArray(k[d],g);-1!=
a.inArray(f,e);)f++;e.push(f)}c.find("th").data("sort-dir",null).removeClass("sorting-desc sorting-asc");b.data("sort-dir",l).addClass("sorting-"+l);f=n.slice(0);for(g=d=0;g<e.length;g++)d=e[g],f[d]=n[g];e=a(f);c.children("tbody").append(e);c.trigger("aftertablesort",{column:j,direction:l});c.css("display")},10))})})};a.fn.stupidtable.dir={ASC:"asc",DESC:"desc"}})(jQuery);
